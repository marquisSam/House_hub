<div class="todo-container">
  <h1>Todo Management</h1>

  <!-- NgxSpinner Component -->
  <ngx-spinner name="todoSpinner" [fullScreen]="false" [zIndex]="99999"> </ngx-spinner>

  <!-- Error handling -->
  @if (error()) {
  <div class="error-message">
    <p>{{ error() }}</p>
    <button (click)="clearError()">Dismiss</button>
  </div>
  }

  <div class="grid">
    <div class="data">
      <h2>Current Todos ({{ todosCount() }})</h2>
      <div class="todo-list">
        @for (todo of todos(); track todo.Id) {
        <div class="todo-item">
          <h3>{{ todo.Title }}</h3>
          <p>{{ todo.Description }}</p>
          <p>Priority: {{ todo.Priority }}</p>
          <p>Category: {{ todo.Category }}</p>
          <p>Due Date: {{ todo.DueDate }}</p>
          <p>Status: {{ todo.IsCompleted ? 'Completed' : 'Pending' }}</p>
        </div>
        } @empty {
        <p>No todos found.</p>
        }
      </div>
    </div>

    <div class="post">
      <h2>Add New Todo</h2>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <label for="Title">Title</label>
        <input type="text" id="Title" formControlName="Title" />

        <label for="Description">Description</label>
        <input type="text" id="Description" formControlName="Description" />

        <label for="DueDate">Due Date</label>
        <input type="date" id="DueDate" formControlName="DueDate" />

        <label for="Priority">Priority</label>
        <input type="number" id="Priority" formControlName="Priority" min="1" max="5" />

        <label for="Category">Category</label>
        <input type="text" id="Category" formControlName="Category" />

        <button type="submit" [disabled]="form.invalid || isLoading()">
          {{ isLoading() ? 'Adding...' : 'Add Todo' }}
        </button>
      </form>
    </div>
  </div>
</div>
